<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.repository.AdminBasicMapper">

    <sql id="criteriaCss">
        <if test="searchType != null and searchKeyword != null">
            <trim prefix="AND (" suffix=")" prefixOverrides="OR">
                <foreach item="type" collection="typeArr">
                    <trim prefix="OR">
                        <choose>
                            <when test="type=='T'.toString()">
                                (CSS_NM LIKE CONCAT('%',#{searchKeyword},'%'))
                            </when>
                        </choose>
                    </trim>
                </foreach>
            </trim>
        </if>
    </sql>

    <insert id="insertMenuTree" parameterType="MenuTree">
        INSERT INTO menu_tree
            (
                IDX,
                PARENT_IDX,
                LVL,
                NAME,
                LINK,
                CREATE_IDX,
                CREATE_DATE,
                USE_YN
            )
        VALUES
        <foreach collection="list" item="item" separator=" , ">
            (
                #{item.idx},
                #{item.parentIdx},
                #{item.lvl},
                #{item.name},
                #{item.link},
                #{item.userIdx},
                SYSDATE(),
                #{item.useYn}
            )
        </foreach>

    </insert>


    <select id="findAllMenuTree" resultType="MenuTree">
        SELECT IDX,
               PARENT_IDX,
               NAME,
               LVL,
               LINK,
               CREATE_IDX,
               CREATE_DATE,
               USE_YN
        FROM MENU_TREE
        ORDER BY IDX
    </select>


    <delete id="deleteMenuTree">

        DELETE FROM menu_tree
        WHERE EXISTS (
                      SELECT 1
                      FROM menu_tree
                  )
    </delete>

    <select id="findAllCssContent" resultType="Css" parameterType="Criteria">
        SELECT IDX,
               CSS_FIRST_ID,
               CSS_SECOND_ID,
               CSS_NM,
               USE_YN,
               CREATE_IDX,
               CREATE_DATE,
               UPDATE_IDX,
               UPDATE_DATE
          FROM css
         WHERE 1 = 1
        <include refid="criteriaCss"/>

    </select>

    <select id="findByIdxCssContent" parameterType="int" resultType="Css">
        SELECT IDX,
               CSS_FIRST_ID,
               CSS_SECOND_ID,
               CSS_NM,
               CSS_CODE,
               USE_YN,
               CREATE_IDX,
               CREATE_DATE,
               UPDATE_IDX,
               UPDATE_DATE
          FROM css
         WHERE IDX = #{idx}
    </select>

    <insert id="insertCssContent" parameterType="map">
        INSERT INTO css
            (
                CSS_FIRST_ID,
                CSS_SECOND_ID,
                CSS_NM,
                CSS_CODE,
                USE_YN,
                CREATE_IDX,
                CREATE_DATE
            )
        VALUES
            (
                #{cssFirstId},
                #{cssSecondId},
                #{cssNm},
                #{cssCode},
                #{useYn},
                #{userIdx},
                SYSDATE
            )
    </insert>

    <update id="updateCssContent" parameterType="map">
        UPDATE css
           SET CSS_FIRST_ID = #{cssFirstId},
               CSS_SECOND_ID = #{cssSecondId},
               CSS_NM = #{cssNm},
               CSS_CODE = #{cssCode},
               USE_YN = #{useYn},
               UPDATE_IDX = #{userIdx},
               UPDATE_DATE = SYSDATE
         WHERE IDX =#{idx}
    </update>

    <delete id="deleteCssContent" parameterType="map">
        DELETE FROM css
         WHERE IDX=#{idx}
    </delete>

</mapper>